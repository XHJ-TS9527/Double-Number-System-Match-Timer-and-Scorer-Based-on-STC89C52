PUBLIC INITIALIZATION_PROG
INITIALIZATION_PROG:
CLR RS0
CLR RS1 ;选择工作寄存器区为0区
TH2 EQU 0CDH
TL2 EQU 0CCH
RLDH EQU 0CBH
RLDL EQU 0CAH
T2MOD EQU 0C9H
T2CON EQU 0C8H
TF2 EQU 0CFH
ET2 EQU 0ADH
TR2 EQU 0CAH ;T2相关控制寄存器的地址
RCLK EQU P3.5
SRCLK EQU P3.6 ;点阵时钟口地址
;存放共阴段码表
MOV R0,#80H
MOV @R0,#3FH ;0
INC R0
MOV @R0,#06H ;1
INC R0
MOV @R0,#5BH ;2
INC R0
MOV @R0,#4FH ;3
INC R0
MOV @R0,#66H ;4
INC R0
MOV @R0,#6DH ;5
INC R0
MOV @R0,#7DH ;6
INC R0
MOV @R0,#07H ;7
INC R0
MOV @R0,#7FH ;8
INC R0
MOV @R0,#6FH ;9
INC R0
MOV @R0,#77H ;A
INC R0
MOV @R0,#7CH ;B
INC R0
MOV @R0,#39H ;C
INC R0
MOV @R0,#5EH ;D
INC R0
MOV @R0,#79H ;E
INC R0
MOV @R0,#71H ;F
;存放点阵字库
MOV R0,#90H
MOV @R0,#00H ;AWIN 90H
INC R0
MOV @R0,#3FH
INC R0
MOV @R0,#48H
INC R0
MOV @R0,#88H
INC R0
MOV @R0,#88H
INC R0
MOV @R0,#48H
INC R0
MOV @R0,#3FH
INC R0
MOV @R0,#00H
INC R0
MOV @R0,#00H ;BWIN 98H
INC R0
MOV @R0,#0FFH
INC R0
MOV @R0,#91H
INC R0
MOV @R0,#91H
INC R0
MOV @R0,#91H
INC R0
MOV @R0,#99H
INC R0
MOV @R0,#66H
INC R0
MOV @R0,#00H
INC R0
MOV @R0,#88H ;平手 A0H
INC R0
MOV @R0,#0A8H
INC R0
MOV @R0,#98H
INC R0
MOV @R0,#0FFH
INC R0
MOV @R0,#0FFH
INC R0
MOV @R0,#98H
INC R0
MOV @R0,#0A8H
INC R0
MOV @R0,#88H
INC R0
MOV @R0,#69H ;0 A8H
INC R0
MOV @R0,#96H
INC R0
MOV @R0,#59H ;1 AAH
INC R0
MOV @R0,#0F1H
INC R0
MOV @R0,#9BH ;2 ACH
INC R0
MOV @R0,#0D9H
INC R0
MOV @R0,#9DH ;3 AEH
INC R0
MOV @R0,#0BFH
INC R0
MOV @R0,#6AH ;4 B0H
INC R0
MOV @R0,#0F2H
INC R0
MOV @R0,#9DH ;5 B2H
INC R0
MOV @R0,#0B9H
INC R0
MOV @R0,#6DH ;6 B4H
INC R0
MOV @R0,#0DAH
INC R0
MOV @R0,#89H ;7 B6H
INC R0
MOV @R0,#0ACH
INC R0
MOV @R0,#0FDH ;8 B8H
INC R0
MOV @R0,#0DBH
INC R0
MOV @R0,#5BH ;9 BAH
INC R0
MOV @R0,#0B6H
INC R0
MOV @R0,#7AH ;A BCH
INC R0
MOV @R0,#0A7H
INC R0
MOV @R0,#0F5H ;B BDH
INC R0
MOV @R0,#57H
INC R0
MOV @R0,#0F9H ;C C0H
INC R0
MOV @R0,#99H
INC R0
MOV @R0,#75H ;D C2H
INC R0
MOV @R0,#5FH
INC R0
MOV @R0,#0FBH ;E C4H
INC R0
MOV @R0,#0DDH
INC R0
MOV @R0,#0FAH ;F C6H
INC R0
MOV @R0,#0AAH
;存放音乐数据
MOV R0,#0CAH
MOV @R0,#0FEH ;高DO CAH
INC R0
MOV @R0,#2AH
INC R0
MOV @R0,#0FDH ;中SO CCH
INC R0
MOV @R0,#8AH
INC R0
MOV @R0,#0FCH ;中DO CEH
INC R0
MOV @R0,#4CH
INC R0
MOV @R0,#0FCH ;中RUI D0H
INC R0
MOV @R0,#0B4H
INC R0
MOV @R0,#0FDH ;中LA升半音 D2H
INC R0
MOV @R0,#0EFH
INC R0
MOV @R0,#0FEH ;高DO D4H
INC R0
MOV @R0,#2AH
INC R0
MOV @R0,#0FCH ;中LA D6H
INC R0
MOV @R0,#0C2H
INC R0
MOV @R0,#0FDH ;中LA升半音 D8H
INC R0
MOV @R0,#0EFH
INC R0
MOV @R0,#0FCH ;中LA DAH
INC R0
MOV @R0,#0C2H
INC R0
MOV @R0,#0FAH ;低MI DCH
INC R0
MOV @R0,#1DH
INC R0
MOV @R0,#0FCH ;中DO DEH
INC R0
MOV @R0,#4CH
;设置定时器工作模式
MOV TMOD,#21H ;T0工作在模式1，T1工作在模式2
MOV TCON,#00H ;两个外部中断低电平触发
MOV T2MOD,#00H
MOV T2CON,#02H  ;计数器T2工作模式（16位自动重装） 
;清理一些标志位
CLR 00H	;比赛开始位
CLR 01H	;键盘输入位
CLR 02H	;比赛暂停位
CLR 03H ;分数进制位
CLR 04H ;比赛结果显示位 
CLR REN
;初始化队伍分数为0
MOV 30H,#00H
MOV 31H,#00H
;中断优先级
MOV IP,#2AH
;关中断
MOV IE,#00H
;载入定时器初值
MOV TH2,#0F0H
MOV TL2,#60H
MOV RLDH,#0F0H
MOV RLDL,#60H ;T2
MOV TL1,#06H
MOV TH1,#06H ;T1
MOV TL0,0CBH
MOV TH0,0CAH ;T0
MOV 53H,#0FEH ;T0初值
MOV 54H,#22H
MOV 40H,#00H ;清空比赛结果
MOV 55H,#0CAH ;清空音乐步骤
MOV 51H,#00H
LCALL MATRIX_SENDBYTE
SETB RCLK
CLR RCLK ;清空点阵，确保数码管清晰可见
RET
END